#![warn(clippy::pathbuf_init_then_push)]

use std::path::PathBuf;

fn main() {
    let mut path_buf = PathBuf::from("foo");

    path_buf = PathBuf::from("foo").join("bar");

    let bar = "bar";
    path_buf = PathBuf::from("foo").join(bar);

    let mut path_buf = PathBuf::from("foo").join("bar").join("buz");

    let mut x = PathBuf::new();
    println!("{}", x.display());
    x.push("Duck");

    let mut path_buf = PathBuf::new();
    #[cfg(cats)]
    path_buf.push("foo");
}

fn wrongly_unmangled_macros() {
    macro_rules! deref {
        ($x:expr) => {
            *$x
        };
    }

    macro_rules! dot_join {
        ($x:expr, $y:expr) => {
            $x.join($y)
        };
    }

    let mut path_buf = dot_join!(PathBuf::from(deref!(&"a")), deref!(&"b")).join(deref!(&"some/path"));
}
